{"version":3,"file":"index.9f934f7a.js","sources":["../../vite/modulepreload-polyfill","../../main.js"],"sourcesContent":["const p = function polyfill() {\n    const relList = document.createElement('link').relList;\n    if (relList && relList.supports && relList.supports('modulepreload')) {\n        return;\n    }\n    for (const link of document.querySelectorAll('link[rel=\"modulepreload\"]')) {\n        processPreload(link);\n    }\n    new MutationObserver((mutations) => {\n        for (const mutation of mutations) {\n            if (mutation.type !== 'childList') {\n                continue;\n            }\n            for (const node of mutation.addedNodes) {\n                if (node.tagName === 'LINK' && node.rel === 'modulepreload')\n                    processPreload(node);\n            }\n        }\n    }).observe(document, { childList: true, subtree: true });\n    function getFetchOpts(script) {\n        const fetchOpts = {};\n        if (script.integrity)\n            fetchOpts.integrity = script.integrity;\n        if (script.referrerpolicy)\n            fetchOpts.referrerPolicy = script.referrerpolicy;\n        if (script.crossorigin === 'use-credentials')\n            fetchOpts.credentials = 'include';\n        else if (script.crossorigin === 'anonymous')\n            fetchOpts.credentials = 'omit';\n        else\n            fetchOpts.credentials = 'same-origin';\n        return fetchOpts;\n    }\n    function processPreload(link) {\n        if (link.ep)\n            // ep marker = processed\n            return;\n        link.ep = true;\n        // prepopulate the load record\n        const fetchOpts = getFetchOpts(link);\n        fetch(link.href, fetchOpts);\n    }\n};__VITE_IS_MODERN__&&p();","import Feature from 'ol/Feature';\nimport Map from 'ol/Map';\nimport {OSM, Vector as VectorSource} from 'ol/source';\nimport View from 'ol/View';\nimport {Circle as CircleStyle, Fill, Stroke, Style} from 'ol/style';\nimport GeoJSON from 'ol/format/GeoJSON';\nimport {Tile as TileLayer, Vector as VectorLayer} from 'ol/layer';\nimport {ZoomToExtent, OverviewMap, defaults as defaultControls} from 'ol/control';\nimport Overlay from 'ol/Overlay';\n\n// Contants for literals\nconst migrationRoutes = ['Afghanistan to Iran', 'Belarus-EU border', 'Caribbean to US', 'Central Mediterranean', 'Central Mediterranean,US-Mexico border crossing', 'Comoros to Mayotte', 'Darien Gap', 'Dominican Republic to Puerto Rico', 'DRC to Uganda', 'Eastern Mediterranean', 'English Channel to the UK', 'Haiti to Dominican Republic', 'Horn of Africa to Yemen crossing', 'Iran to Turkey', 'Italy to France', 'Sahara Desert crossing', 'Syria to Turkey', 'Turkey-Europe land route', 'Ukraine to Europe', 'US-Mexico border crossing', 'Venezuela to Caribbean', 'Western Africa / Atlantic route to the Canary Islands', 'Western Balkans', 'Western Mediterranean'];\n\n// Colors\nconst colors = ['#3982D0', '#D96D73', '#5A59A6', '#6DB6A1', '#F78B41', '#5DB9E0', '#418A8B', '#A2578D', '#E5B75D',\n  '#234E63', '#90B9E5', '#A74460', '#A2A2CD', '#50826F', '#FABD94', '#3B98AB', '#8AC7C8', '#6D466B'];\n\n// Constants with colors\nconst styles = [];\n\n// Load colors in constants\nfor (let i = 0; i<colors.length; i++) {\n  styles.push(\n      new Style({\n        image: new CircleStyle({\n          radius: 10,\n          fill: new Fill({color: colors[i]}),\n          stroke: new Stroke({color: '#666666', width: 1})\n        }),\n      })\n  );\n}\n\nfunction getElementFromConstantOrder(constant, constantList, destinationList) {\n  const index = constantList.indexOf(constant) || 0;\n  return destinationList[index % destinationList.length];\n}\n\nvar data;\nvar filteredData;\nfunction loadData() {\n  var csvFile = 'https://missingmigrants.iom.int/sites/g/files/tmzbdl601/files/report-migrant-incident/Missing_Migrants_Global_Figures_allData.csv';\n  $.ajax({\n    type: \"GET\",\n    url: csvFile,\n    dataType: \"text\",\n    success: function(response) {\n      data = $.csv.toObjects(response);\n      loadMap(data);\n    }\n  });\n}\n\nfunction search() {\n  if (!data) {\n    loadData();\n  } else {\n    const migrationRoute = $('#fieldMigrationRoute').find(\":selected\").val();\n    const originRegion = $('#fieldRegionOrigin').find(\":selected\").val();\n    const deathCause = $('#fieldDeathCause').find(\":selected\").val();\n    const incidentRegion = $('#fieldIncidentRegion').find(\":selected\").val();\n\n    filteredData = new Array();\n    for (let i = 0; i < data.length; ++i) {\n      let include = true;\n      if (migrationRoute && data[i][\"Migration route\"] !== migrationRoute) {\n        include = false;\n      } else if (originRegion && data[i][\"Region of Origin\"] !== originRegion) {\n        include = false;\n      } else if (deathCause && data[i][\"Cause of Death\"] !== deathCause) {\n        include = false;\n      } else if (incidentRegion && data[i][\"Region of Incident\"] !== incidentRegion) {\n        include = false;\n      }\n      if (include) {\n        filteredData.push(data[i]);\n      }\n    }\n    loadMap(filteredData);\n  }\n}\n\n$(\"#searchButton\").click(function() {\n  search();\n});\n\n\nconst projection = 'EPSG:3857';\n\nvar map, vectorLayer, vectorSource;\n\nfunction loadMap(data) {\n  let geojsonObject = {\n    \"type\":\"FeatureCollection\",\n    \"crs\":{\n      \"type\":\"name\",\n      \"properties\":{\n        \"name\": projection\n      }\n    },\n    \"features\":[]\n  }\n\n  const features = new Array();\n  let totalDeath = 0;\n  let totalWomen = 0;\n  let totalChildren = 0;\n  const max = data.length;\n  for (let i = 0; i < data.length && i < max; ++i) {\n    const coordinates = data[i].Coordinates;\n    if (coordinates) {\n      const latLong = coordinates.substring('POINT('.length + 1, coordinates.length - 1).split(' ');\n      const latitude = latLong[0] * 100000;\n      const longitude = latLong[1] * 100000;\n      geojsonObject.features.push({\n        \"type\":\"Feature\",\n        \"geometry\":{\n          \"type\":\"Point\",\n          \"coordinates\":[\n            latitude,\n            longitude\n          ]\n        },\n        \"properties\": {\n          \"originRegion\": data[i][\"Region of Origin\"],\n          \"incidentRegion\": data[i][\"Region of Incident\"],\n          \"year\": data[i][\"Incident year\"],\n          \"month\": data[i][\"Reported Month\"],\n          \"numDeathMissing\": data[i][\"Total Number of Dead and Missing\"],\n          \"numSurvivors\": data[i][\"Number of Survivors\"],\n          \"migrationRoute\": data[i][\"Migration route\"],\n          \"deathLocation\": data[i][\"Location of death\"],\n          \"articleTitle\": data[i][\"Article title\"],\n          \"mainId\": data[i][\"Main ID\"],\n          \"numDeathFemales\": data[i][\"Number of Females\"],\n          \"numDeathMales\": data[i][\"Number of Males\"],\n          \"numDeathChildren\": data[i][\"Number of Children\"],\n          \"deathCause\": data[i][\"Cause of Death\"]\n        }\n      });\n    }\n    totalDeath += Number(data[i][\"Total Number of Dead and Missing\"]) || 0;\n    totalWomen += Number(data[i][\"Number of Females\"]) || 0;\n    totalChildren += Number(data[i][\"Number of Children\"]) || 0;\n  }\n  console.log(geojsonObject);\n\n  vectorSource = new VectorSource({\n      features: new GeoJSON().readFeatures(geojsonObject)\n    });\n\n  const styleFunction = function (feature) {\n    return getElementFromConstantOrder(feature.getProperties()[\"migrationRoute\"], migrationRoutes, styles);\n  };\n\n  if (!vectorLayer) {\n    vectorLayer = new VectorLayer({\n      source: vectorSource,\n      style: styleFunction\n    });\n  } else {\n    vectorLayer.setSource(vectorSource);\n    vectorLayer.getSource().changed();\n  }\n\n  const layers = [new TileLayer({\n    source: new OSM(),\n  }), vectorLayer];\n\n  const overviewMapControl = new OverviewMap({\n    layers: layers,\n  });\n\n  if (!map) {\n    map = new Map({\n      layers: layers,\n      target: document.getElementById('map'),\n      view: new View({\n        center: [40, 0],\n        zoom: 1,\n        projection: projection\n      }),\n      controls: defaultControls().extend([\n        overviewMapControl\n      ]),\n    });\n    const popupElement = document.getElementById('popup');\n    const popupContent = document.getElementById('popup-content');\n    const tableContent = document.getElementById('table-content');\n    const closer = document.getElementById('popup-closer');\n\n    const popup = new Overlay({\n      element: popupElement,\n      positioning: 'bottom-center',\n      stopEvent: false,\n      autoPan: {\n        animation: {\n          duration: 250,\n        },\n      }\n    });\n\n    map.addOverlay(popup);\n\n    closer.onclick = function () {\n      popup.setPosition(undefined);\n      popupContent.innerHTML = '';\n      tableContent.innerHTML = '';\n      closer.blur();\n      return false;\n    };\n\n    // display popup on click\n    map.on('click', function (evt) {\n      const feature = map.forEachFeatureAtPixel(evt.pixel, function (feature) {\n        return feature;\n      });\n      if (feature) {\n        popup.setPosition(evt.coordinate);\n        popupContent.innerHTML = '<div class=\"row justify-content-center\">\\n' +\n            '<div class=\"col-auto\">\\n' +\n            '<table class=\"table table-responsive\">\\n' +\n            '  <tbody>\\n' +\n            '    <tr>\\n' +\n            '      <th scope=\"row\">Dead and missing</th>\\n' +\n            '      <td>' + feature.getProperties()[\"numDeathMissing\"] || 'N/A' + '</td>\\n' +\n            '      <th scope=\"row\">Survivors</th>\\n' +\n            '      <td>' + feature.getProperties()[\"numSurvivors\"] || 'N/A' + '</td>\\n' +\n            '    </tr>\\n' +\n            '    <tr>\\n' +\n            '      <th scope=\"row\">Females dead</th>\\n' +\n            '      <td>' + feature.getProperties()[\"numDeathFemales\"] || 'N/A' + '</td>\\n' +\n            '      <th scope=\"row\">Childrens dead</th>\\n' +\n            '      <td>' + feature.getProperties()[\"numDeathChildren\"] || 'N/A' + '</td>\\n' +\n            '    </tr>\\n' +\n            '  </tbody>\\n' +\n            '</table>' +\n            '<a href=\"#table-content\" class=\"link-info\">More info</a>' +\n            '</div></div>';\n        tableContent.innerHTML = '<table class=\"table\">\\n' +\n            '  <tbody>\\n' +\n            '    <tr>\\n' +\n            '      <th scope=\"row\">Region of Origin</th>\\n' +\n            '      <td>' + feature.getProperties()[\"originRegion\"] + '</td>\\n' +\n            '      <th scope=\"row\">Region of Incident</th>\\n' +\n            '      <td>' + feature.getProperties()[\"incidentRegion\"] + '</td>\\n' +\n            '    </tr>\\n' +\n            '    <tr>\\n' +\n            '      <th scope=\"row\">Incident year</th>\\n' +\n            '      <td>' + feature.getProperties()[\"year\"] + '</td>\\n' +\n            '      <th scope=\"row\">Reported Month</th>\\n' +\n            '      <td>' + feature.getProperties()[\"month\"] + '</td>\\n' +\n            '    </tr>\\n' +\n            '    <tr>\\n' +\n            '      <th scope=\"row\">Total Number of Dead and Missing</th>\\n' +\n            '      <td>' + feature.getProperties()[\"numDeathMissing\"] + '</td>\\n' +\n            '      <th scope=\"row\">Number of Survivors</th>\\n' +\n            '      <td>' + feature.getProperties()[\"numSurvivors\"] + '</td>\\n' +\n            '    </tr>\\n' +\n            '    <tr>\\n' +\n            '      <th scope=\"row\">Number of Females Death</th>\\n' +\n            '      <td>' + feature.getProperties()[\"numDeathFemales\"] + '</td>\\n' +\n            '      <th scope=\"row\">Number of Children Death</th>\\n' +\n            '      <td>' + feature.getProperties()[\"numDeathChildren\"] + '</td>\\n' +\n            '    </tr>\\n' +\n            '    <tr>\\n' +\n            '      <th scope=\"row\">Migration route</th>\\n' +\n            '      <td>' + feature.getProperties()[\"migrationRoute\"] + '</td>\\n' +\n            '      <th scope=\"row\">Location of death</th>\\n' +\n            '      <td>' + feature.getProperties()[\"deathLocation\"] + '</td>\\n' +\n            '    </tr>\\n' +\n            '    <tr>\\n' +\n            '      <th scope=\"row\">Article title</th>\\n' +\n            '      <td>' + feature.getProperties()[\"articleTitle\"] + '</td>\\n' +\n            '    </tr>\\n' +\n            '  </tbody>\\n' +\n            '</table>'\n      }\n    });\n  }\n\n  updateTotalNumbers(totalDeath, totalWomen, totalChildren);\n  map.updateSize();\n}\n\nfunction updateTotalNumbers(totalDeath, totalWomen, totalChildren) {\n  $(\"#totalDeathMissing\").text(totalDeath);\n  $(\"#totalWomen\").text(totalWomen);\n  $(\"#totalChildren\").text(totalChildren);\n}\n\nsearch();"],"names":["defaultControls"],"mappings":"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"}